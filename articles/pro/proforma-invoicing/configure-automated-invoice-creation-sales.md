---
title: Nastavení automatického vytváření faktur
description: Tento téma poskytuje informace o nastavení a konfiguraci automatického vytváření proforma faktur.
author: rumant
ms.date: 04/05/2021
ms.topic: article
ms.reviewer: kfend
ms.author: rumant
ms.openlocfilehash: 2d212f2279b28d900e75d45386e343f95b8e825e
ms.sourcegitcommit: 40f68387f594180af64a5e5c748b6efa188bd300
ms.translationtype: HT
ms.contentlocale: cs-CZ
ms.lasthandoff: 05/10/2021
ms.locfileid: "6004163"
---
# <a name="set-up-automatic-invoice-creation"></a><span data-ttu-id="1dfd9-103">Nastavení automatického vytváření faktur</span><span class="sxs-lookup"><span data-stu-id="1dfd9-103">Set up automatic invoice creation</span></span> 
 
<span data-ttu-id="1dfd9-104">_**Platí pro:** omezené nasazení – dohoda o pro forma fakturaci, Project Operations pro scénáře založené na zdrojích / položkách, které nejsou na skladě_</span><span class="sxs-lookup"><span data-stu-id="1dfd9-104">_**Applies To:** Lite deployment - deal to proforma invoicing, Project Operations for resource/non-stocked based scenarios_</span></span>

<span data-ttu-id="1dfd9-105">V Dynamics 365 Project Operations můžete konfigurovat automatické vytváření faktur.</span><span class="sxs-lookup"><span data-stu-id="1dfd9-105">You can configure automatic invoice creation in Dynamics 365 Project Operations.</span></span> <span data-ttu-id="1dfd9-106">Systém vytvoří koncept proforma faktury na základě rozpisu faktury pro každou projektovou smlouvu a řádek smlouvy.</span><span class="sxs-lookup"><span data-stu-id="1dfd9-106">The system creates a draft proforma invoice based on the invoice schedule for each project contract and contract line.</span></span> <span data-ttu-id="1dfd9-107">Rozpisy faktur jsou konfigurovány na úrovni řádku smlouvy.</span><span class="sxs-lookup"><span data-stu-id="1dfd9-107">Invoice schedules are configured at the contract line level.</span></span> <span data-ttu-id="1dfd9-108">Každý řádek ve smlouvě může mít odlišný rozpis faktury nebo stejný rozpis faktury může být obsažen v každém řádku smlouvy.</span><span class="sxs-lookup"><span data-stu-id="1dfd9-108">Each line on a contract can have a distinct invoice schedule, or the same invoice schedule can be included on every line of the contract.</span></span>

<span data-ttu-id="1dfd9-109">Když vytvoříte fakturu, systém vždy vytvoří alespoň jednu fakturu na projektovou smlouvu.</span><span class="sxs-lookup"><span data-stu-id="1dfd9-109">When you create an invoice, the system always creates at least one invoice per project contract.</span></span> <span data-ttu-id="1dfd9-110">V některých případech může být vytvořeno více faktur.</span><span class="sxs-lookup"><span data-stu-id="1dfd9-110">In some cases, there may be multiple invoices created.</span></span> <span data-ttu-id="1dfd9-111">Například pokud má smlouva více zákazníků, bude vytvořen stejný počet faktur jako počet zákazníků, kteří mají fakturovatelné transakce k fakturaci na danou smlouvu projektu.</span><span class="sxs-lookup"><span data-stu-id="1dfd9-111">For example, if the contract has multiple customers, the same number of invoices will be created as the number of customers that have billable transactions to invoice on that project contract.</span></span>

## <a name="understand-how-transactions-are-included-on-an-invoice"></a><span data-ttu-id="1dfd9-112">Pochopení, jak jsou transakce zahrnuty na faktuře</span><span class="sxs-lookup"><span data-stu-id="1dfd9-112">Understand how transactions are included on an invoice</span></span> 

<span data-ttu-id="1dfd9-113">Někdy každý řádek smlouvy na základě projektu určuje samostatný rozpis faktur.</span><span class="sxs-lookup"><span data-stu-id="1dfd9-113">Sometimes, each project-based contract line specifies a separate invoice schedule.</span></span> <span data-ttu-id="1dfd9-114">Například implementační služby pro smlouvu Adatum mají následující řádky smlouvy:</span><span class="sxs-lookup"><span data-stu-id="1dfd9-114">For example, implementation services for the Adatum contract have the following contract lines:</span></span>

- <span data-ttu-id="1dfd9-115">Prototypová práce, která je pevná cena se dvěma ručně vytvořenými milníky.</span><span class="sxs-lookup"><span data-stu-id="1dfd9-115">Prototype work that is a fixed price with two manually created milestones.</span></span>
- <span data-ttu-id="1dfd9-116">Implementační práce, která zahrnuje čas a bude účtována každé dva týdny v pondělí.</span><span class="sxs-lookup"><span data-stu-id="1dfd9-116">Implementation work that includes Time and will be billed bi-weekly on Mondays.</span></span>
- <span data-ttu-id="1dfd9-117">Vzniklé výdaje, které je třeba účtovat měsíčně první pondělí každého měsíce.</span><span class="sxs-lookup"><span data-stu-id="1dfd9-117">Expenses incurred that need to be billed monthly on the first Monday of each month.</span></span>

<span data-ttu-id="1dfd9-118">Rozpisy faktur definované u každé z těchto dvou řádkových položek vypadají jako v následující tabulce:</span><span class="sxs-lookup"><span data-stu-id="1dfd9-118">Invoice schedules defined on each of these two line items look like the following table:</span></span>

| <span data-ttu-id="1dfd9-119">Řádek smlouvy</span><span class="sxs-lookup"><span data-stu-id="1dfd9-119">Contract line</span></span> | <span data-ttu-id="1dfd9-120">Datum spuštění faktury</span><span class="sxs-lookup"><span data-stu-id="1dfd9-120">Invoice run date</span></span> | <span data-ttu-id="1dfd9-121">Mezní datum transakce</span><span class="sxs-lookup"><span data-stu-id="1dfd9-121">Transaction cut-off date</span></span> | <span data-ttu-id="1dfd9-122">Datum milníku</span><span class="sxs-lookup"><span data-stu-id="1dfd9-122">Milestone date</span></span> | <span data-ttu-id="1dfd9-123">Částka milníku</span><span class="sxs-lookup"><span data-stu-id="1dfd9-123">Milestone amount</span></span> |
| --- | --- | --- | --- | --- |
| <span data-ttu-id="1dfd9-124">Prototypová práce</span><span class="sxs-lookup"><span data-stu-id="1dfd9-124">Prototype work</span></span> | <span data-ttu-id="1dfd9-125">Pondělí 5. října</span><span class="sxs-lookup"><span data-stu-id="1dfd9-125">October 5, Monday</span></span> | - | <span data-ttu-id="1dfd9-126">Pondělí 5. října</span><span class="sxs-lookup"><span data-stu-id="1dfd9-126">October 5, Monday</span></span> | <span data-ttu-id="1dfd9-127">5000 USD</span><span class="sxs-lookup"><span data-stu-id="1dfd9-127">5000 USD</span></span> |
| - | <span data-ttu-id="1dfd9-128">Úterý 3. listopadu</span><span class="sxs-lookup"><span data-stu-id="1dfd9-128">November 3, Tuesday</span></span> | - | <span data-ttu-id="1dfd9-129">Úterý 3. listopadu</span><span class="sxs-lookup"><span data-stu-id="1dfd9-129">November 3, Tuesday</span></span> | <span data-ttu-id="1dfd9-130">12,000 USD</span><span class="sxs-lookup"><span data-stu-id="1dfd9-130">12,000 USD</span></span> |
| <span data-ttu-id="1dfd9-131">Implementační práce</span><span class="sxs-lookup"><span data-stu-id="1dfd9-131">Implementation work</span></span> | <span data-ttu-id="1dfd9-132">Pondělí 5. října</span><span class="sxs-lookup"><span data-stu-id="1dfd9-132">October 5, Monday</span></span> | <span data-ttu-id="1dfd9-133">Neděle 4. října</span><span class="sxs-lookup"><span data-stu-id="1dfd9-133">October 4, Sunday</span></span> | - | - |
| - | <span data-ttu-id="1dfd9-134">Pondělí 19. října</span><span class="sxs-lookup"><span data-stu-id="1dfd9-134">October 19, Monday</span></span> | <span data-ttu-id="1dfd9-135">Neděle 18. října</span><span class="sxs-lookup"><span data-stu-id="1dfd9-135">October 18, Sunday</span></span> | - | - |
| - | <span data-ttu-id="1dfd9-136">Pondělí 2. listopadu</span><span class="sxs-lookup"><span data-stu-id="1dfd9-136">November 2, Monday</span></span> | <span data-ttu-id="1dfd9-137">Neděle 1. listopadu</span><span class="sxs-lookup"><span data-stu-id="1dfd9-137">November 1, Sunday</span></span> | - | - |
| - | <span data-ttu-id="1dfd9-138">Pondělí 16. listopadu</span><span class="sxs-lookup"><span data-stu-id="1dfd9-138">November 16, Monday</span></span> | <span data-ttu-id="1dfd9-139">Neděle 15. listopadu</span><span class="sxs-lookup"><span data-stu-id="1dfd9-139">November 15, Sunday</span></span> | - | - |
| <span data-ttu-id="1dfd9-140">Vzniklé výdaje</span><span class="sxs-lookup"><span data-stu-id="1dfd9-140">Expenses incurred</span></span> | <span data-ttu-id="1dfd9-141">Pondělí 5. října</span><span class="sxs-lookup"><span data-stu-id="1dfd9-141">October 5, Monday</span></span> | <span data-ttu-id="1dfd9-142">Neděle 4. října</span><span class="sxs-lookup"><span data-stu-id="1dfd9-142">October 4, Sunday</span></span> | - | - |
| - | <span data-ttu-id="1dfd9-143">Pondělí 2. listopadu</span><span class="sxs-lookup"><span data-stu-id="1dfd9-143">November 2, Monday</span></span> | <span data-ttu-id="1dfd9-144">Neděle 1. listopadu</span><span class="sxs-lookup"><span data-stu-id="1dfd9-144">November 1, Sunday</span></span> | - | - |

<span data-ttu-id="1dfd9-145">V tomto příkladu, když je automatická fakturace spuštěna:</span><span class="sxs-lookup"><span data-stu-id="1dfd9-145">In this example when the automatic invoicing runs on:</span></span>

- <span data-ttu-id="1dfd9-146">**4. října nebo jakékoli dřívější datum**: Pro tuto smlouvu není generována žádná faktura, protože tabulka **Rozpis faktury** pro každý z těchto řádků smlouvy neobsahuje neděli 4. října jako datum spuštění faktury.</span><span class="sxs-lookup"><span data-stu-id="1dfd9-146">**October 4 or any date before**: No invoice is generated for this contract because the **Invoice Schedule** table for each of these contract lines doesn't call out October 4, Sunday as an invoice run date.</span></span>
- <span data-ttu-id="1dfd9-147">**Pondělí 5. října**: Jedna faktura je generována pro:</span><span class="sxs-lookup"><span data-stu-id="1dfd9-147">**October 5 Monday**: One invoice is generated for:</span></span>

    - <span data-ttu-id="1dfd9-148">Prototypová práce zahrnující milník, pokud je označen jako **Připraveno k fakturaci**.</span><span class="sxs-lookup"><span data-stu-id="1dfd9-148">Prototype work that includes the milestone, if it is marked as **Ready to Invoice**.</span></span>
    - <span data-ttu-id="1dfd9-149">Implementační práce, která zahrnuje všechny časové transakce vytvořené před datem uzavření transakce v neděli 4. října, která je označena jako **Připravena k fakturaci**.</span><span class="sxs-lookup"><span data-stu-id="1dfd9-149">Implementation work that includes all Time transactions created before the transaction cut-off date of October 4, Sunday, that is marked as **Ready to Invoice**.</span></span>
    - <span data-ttu-id="1dfd9-150">Vzniklé výdaje, které zahrnují všechny výdajové transakce vytvořené před datem uzavření transakce v neděli 4. října, která je označena jako **Připravena k fakturaci**.</span><span class="sxs-lookup"><span data-stu-id="1dfd9-150">Expense incurred that includes all Expense transactions created before the transaction cut-off date of October 4, Sunday, that is marked as **Ready to Invoice**.</span></span>
  
- <span data-ttu-id="1dfd9-151">**6. října nebo jakékoli datum před 19. říjnem**: Pro tuto smlouvu není generována žádná faktura, protože tabulka **Rozpis faktury** pro každý z těchto řádků smlouvy neobsahuje 6. října ani žádné datum před 19. říjnem jako datum spuštění faktury.</span><span class="sxs-lookup"><span data-stu-id="1dfd9-151">**On October 6 or any date before October 19**: No invoice is generated for this contract since the **Invoice Schedule** table for each of these contract lines does not call out October 6 or any date before October 19 as an invoice run date.</span></span>
- <span data-ttu-id="1dfd9-152">**Pondělí 19. října**: Jedna faktura je vygenerována pro implementační práci, která zahrnuje všechny časové transakce vytvořené před datem uzavření transakce v neděli 18. října, která je označena jako **Připravena k fakturaci**.</span><span class="sxs-lookup"><span data-stu-id="1dfd9-152">**October 19, Monday**: One invoice is generated for implementation work that includes all Time transactions created before the transaction cut-off date of October 18, Sunday, that is marked as **Ready to Invoice**.</span></span>
- <span data-ttu-id="1dfd9-153">**Pondělí 2. listopadu**: Jedna faktura je generována pro:</span><span class="sxs-lookup"><span data-stu-id="1dfd9-153">**November 2 Monday**: One invoice is generated for:</span></span>

    - <span data-ttu-id="1dfd9-154">Implementační práce, která zahrnuje všechny časové transakce vytvořené před datem uzavření transakce v neděli 1. listopadu, která je označena jako **Připravena k fakturaci**.</span><span class="sxs-lookup"><span data-stu-id="1dfd9-154">Implementation work that includes all Time transactions created before the transaction cut-off date of November 1, Sunday, that is marked as **Ready to Invoice**.</span></span>
    - <span data-ttu-id="1dfd9-155">Vzniklé výdaje, které zahrnují všechny výdajové transakce vytvořené před datem uzavření transakce v neděli 1. listopadu, která je označena jako **Připravena k fakturaci**.</span><span class="sxs-lookup"><span data-stu-id="1dfd9-155">Expense incurred that includes all Expense transactions created before the transaction cut-off date of November 1, Sunday, that is marked as **Ready to Invoice**.</span></span>

- <span data-ttu-id="1dfd9-156">**Úterý 3. listopadu**: Za prototypovou práci je vygenerována jedna faktura, která obsahuje milník pro 12 000 USD, pokud je označena jako **Připraveno k fakturaci**.</span><span class="sxs-lookup"><span data-stu-id="1dfd9-156">**November 3, Tuesday**: One invoice is generated for prototype work that includes the milestone for 12000 USD, if it is marked as **Ready to Invoice**.</span></span>

## <a name="configure-automatic-invoicing"></a><span data-ttu-id="1dfd9-157">Konfigurovat automatické fakturování</span><span class="sxs-lookup"><span data-stu-id="1dfd9-157">Configure automatic invoicing</span></span>

<span data-ttu-id="1dfd9-158">Chcete-li nakonfigurovat spuštění automatické fakturace, postupujte následovně.</span><span class="sxs-lookup"><span data-stu-id="1dfd9-158">Complete the following steps to configure an automated invoice run.</span></span>

1. <span data-ttu-id="1dfd9-159">V nabídce **Project Operations** jděte do **Nastavení** > **Nastavení opakované fakturace**.</span><span class="sxs-lookup"><span data-stu-id="1dfd9-159">In **Project Operations**, go to **Settings** > **Recurring Invoice Setup**.</span></span>
2. <span data-ttu-id="1dfd9-160">Vytvořte dávkovou úlohu a pojmenujte ji **rVytvořit faktury v Project Operations**.</span><span class="sxs-lookup"><span data-stu-id="1dfd9-160">Create a batch job, and name it **rPoject Operations Create Invoices**.</span></span> <span data-ttu-id="1dfd9-161">Název dávkové úlohy musí obsahovat slova „Vytvořit faktury”.</span><span class="sxs-lookup"><span data-stu-id="1dfd9-161">The name of the batch job must include the words, "create invoices".</span></span>
3. <span data-ttu-id="1dfd9-162">V poli **Typ úlohy** vyberte **Žádný**.</span><span class="sxs-lookup"><span data-stu-id="1dfd9-162">In the **Job Type** field, select **None**.</span></span> <span data-ttu-id="1dfd9-163">Ve výchozím nastavení jsou pole **Frekvence denně** a **Je aktivní** nastaveny na **Ano**.</span><span class="sxs-lookup"><span data-stu-id="1dfd9-163">By default, the **Frequency Daily** and **Is Active** fields are set to **Yes**.</span></span>
4. <span data-ttu-id="1dfd9-164">Vyberte **Spustit pracovní postup**.</span><span class="sxs-lookup"><span data-stu-id="1dfd9-164">Select **Run Workflow**.</span></span> <span data-ttu-id="1dfd9-165">V dialogovém okně **Vyhledat záznam** se zobrazí tři pracovní postupy:</span><span class="sxs-lookup"><span data-stu-id="1dfd9-165">In the **Look Up Record** dialog box, you will see three workflows:</span></span>

- <span data-ttu-id="1dfd9-166">ProcessRunCaller</span><span class="sxs-lookup"><span data-stu-id="1dfd9-166">ProcessRunCaller</span></span>
- <span data-ttu-id="1dfd9-167">ProcessRunner</span><span class="sxs-lookup"><span data-stu-id="1dfd9-167">ProcessRunner</span></span>
- <span data-ttu-id="1dfd9-168">UpdateRoleUtilization</span><span class="sxs-lookup"><span data-stu-id="1dfd9-168">UpdateRoleUtilization</span></span>

5. <span data-ttu-id="1dfd9-169">Vyberte **ProcessRunCaller** a potom vyberte **Přidat**.</span><span class="sxs-lookup"><span data-stu-id="1dfd9-169">Select **ProcessRunCaller**, and then select **Add**.</span></span>
6. <span data-ttu-id="1dfd9-170">V dalším dialogovém okně vyberte **OK**.</span><span class="sxs-lookup"><span data-stu-id="1dfd9-170">In the next dialog box, select **OK**.</span></span> <span data-ttu-id="1dfd9-171">Po pracovním postupu **Spánek** následuje pracovní postup **Zpracovat**.</span><span class="sxs-lookup"><span data-stu-id="1dfd9-171">A **Sleep** workflow is followed by a **Process** workflow.</span></span> 

> [!NOTE]
> <span data-ttu-id="1dfd9-172">Pracovní postup **ProcessRunner** můžete také vybrat v kroku 5.</span><span class="sxs-lookup"><span data-stu-id="1dfd9-172">You can also select **ProcessRunner** in step 5.</span></span> <span data-ttu-id="1dfd9-173">Když potom vyberete **OK**, bude pracovní postup **Zpracovat** následován pracovním postupem **Spánek**.</span><span class="sxs-lookup"><span data-stu-id="1dfd9-173">Then, when you select **OK**, a **Process** workflow is followed by a **Sleep** workflow.</span></span>

<span data-ttu-id="1dfd9-174">Pracovní postupy **ProcessRunCaller** a **ProcessRunner** vytvářejí faktury.</span><span class="sxs-lookup"><span data-stu-id="1dfd9-174">The **ProcessRunCaller** and **ProcessRunner** workflows create invoices.</span></span> <span data-ttu-id="1dfd9-175">**ProcessRunCaller** volá **ProcessRunner**.</span><span class="sxs-lookup"><span data-stu-id="1dfd9-175">**ProcessRunCaller** calls **ProcessRunner**.</span></span> <span data-ttu-id="1dfd9-176">**ProcessRunner** je pracovní postup, který skutečně vytváří faktury.</span><span class="sxs-lookup"><span data-stu-id="1dfd9-176">**ProcessRunner** is the workflow that actually creates the invoices.</span></span> <span data-ttu-id="1dfd9-177">Pracovní postup prochází všemi řádky smluv, pro které musí být vytvořeny faktury, a vytváří faktury pro tyto řádky.</span><span class="sxs-lookup"><span data-stu-id="1dfd9-177">The workflow goes through all the contract lines that invoices must be created for, and creates invoices for those lines.</span></span> <span data-ttu-id="1dfd9-178">Aby určil řádky smluv, pro které musí být vytvořeny faktury, vyhledává úloha data spuštění faktury pro řádky smluv.</span><span class="sxs-lookup"><span data-stu-id="1dfd9-178">To determine the contract lines that invoices must be created for, the job looks at invoice run dates for the contract lines.</span></span> <span data-ttu-id="1dfd9-179">Jestliže řádky smluv, které patří k jedné smlouvě, mají stejné datum spuštění faktury, budou transakce sloučeny do jedné faktury, která má dva řádky faktury.</span><span class="sxs-lookup"><span data-stu-id="1dfd9-179">If contract lines that belong to one contract have the same invoice run date, the transactions are combined into one invoice that has two invoice lines.</span></span> <span data-ttu-id="1dfd9-180">Pokud neexistují žádné transakce pro vytvoření faktur, úloha přeskočí vytvoření faktury.</span><span class="sxs-lookup"><span data-stu-id="1dfd9-180">If there are no transactions to create invoices for, the job skips creating an invoice.</span></span>

<span data-ttu-id="1dfd9-181">Proces **ProcessRunner** po svém dokončení volá proces **ProcessRunCaller**, poskytne čas ukončení a je zavřen.</span><span class="sxs-lookup"><span data-stu-id="1dfd9-181">After **ProcessRunner** has finished running, it calls **ProcessRunCaller**, provides the end time, and is closed.</span></span> <span data-ttu-id="1dfd9-182">Proces **ProcessRunCaller** poté spustí časovač, který běží po dobu 24 hodin od zadaného času ukončení.</span><span class="sxs-lookup"><span data-stu-id="1dfd9-182">**ProcessRunCaller** then starts a timer that runs for 24-hours from the specified end time.</span></span> <span data-ttu-id="1dfd9-183">Po doběhnutí časovače je **ProcessRunCaller** uzavřen.</span><span class="sxs-lookup"><span data-stu-id="1dfd9-183">At the end of the timer, **ProcessRunCaller** is closed.</span></span>

<span data-ttu-id="1dfd9-184">Úloha dávkového zpracování pro vytváření faktur je opakující se úloha.</span><span class="sxs-lookup"><span data-stu-id="1dfd9-184">The batch process job for creating invoices is a recurrent job.</span></span> <span data-ttu-id="1dfd9-185">Pokud je tento dávkový proces spuštěn vícekrát, vytvoří se více instancí této úlohy a způsobí chyby.</span><span class="sxs-lookup"><span data-stu-id="1dfd9-185">If this batch process is run many times, multiple instances of the job are created and causes errors.</span></span> <span data-ttu-id="1dfd9-186">Proto byste tento dávkový proces měli spustit pouze jednou a restartovat ho, pouze pokud přestane běžet.</span><span class="sxs-lookup"><span data-stu-id="1dfd9-186">Therefore, you should start the batch process only one time, and then restart only if it stops running.</span></span>

> [!NOTE]
> <span data-ttu-id="1dfd9-187">Dávková fakturace v Project Operations běží pouze pro řádky projektové smlouvy, které jsou konfigurovány podle plánů faktur.</span><span class="sxs-lookup"><span data-stu-id="1dfd9-187">Batch invoicing in Project Operations only runs for project contract lines that are configured by invoice schedules.</span></span> <span data-ttu-id="1dfd9-188">Řáeke smlouvy s metodou fakturace s pevnou cenou musí mít nakonfigurované milníky.</span><span class="sxs-lookup"><span data-stu-id="1dfd9-188">A contract line with a fixed price billing method must have milestones configured.</span></span> <span data-ttu-id="1dfd9-189">Řádek smlouvy o projektu s metodou fakturace času a materiálu bude vyžadovat sestavení časového rozvrhu faktur.</span><span class="sxs-lookup"><span data-stu-id="1dfd9-189">A project contract line with a time and material billing method will need a date-based invoice schedule set up.</span></span>


[!INCLUDE[footer-include](../../includes/footer-banner.md)]
