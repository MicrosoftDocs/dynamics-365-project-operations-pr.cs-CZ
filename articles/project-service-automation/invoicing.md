---
title: Fakturace v Project Service Automation
description: Toto téma poskytuje informace o fakturaci.
author: rumant
manager: kfend
ms.service: business-applications
ms.custom:
- dyn365-projectservice
ms.date: 03/11/2019
ms.topic: article
ms.prod: ''
ms.technology: Microsoft Dynamics 365  Project Service Automation 2.x and 3.x
audience: Admin
search.audienceType:
- admin
- customizer
- enduser
search.app:
- D365PS
ms.openlocfilehash: 8d95f17aba0a4cab65a6f020aade5e19568de3be
ms.sourcegitcommit: 8c786230ef2a497280885b827162561776e2eb00
ms.translationtype: HT
ms.contentlocale: cs-CZ
ms.lasthandoff: 03/24/2020
ms.locfileid: "3750259"
---
# <a name="invoicing-in-project-service-automation"></a><span data-ttu-id="8935b-103">Fakturace v Project Service Automation</span><span class="sxs-lookup"><span data-stu-id="8935b-103">Invoicing in Project Service Automation</span></span>

[!INCLUDE[cc-applies-to-psa-app-3.x](../includes/cc-applies-to-psa-app-3x.md)]

<span data-ttu-id="8935b-104">Fakturace v Dynamics 365 Project Service Automation je užitečná, protože projektovým manažerům poskytuje druhou úroveň schválení před tím, než vytvoří faktury pro zákazníky.</span><span class="sxs-lookup"><span data-stu-id="8935b-104">Invoicing in Dynamics 365 Project Service Automation is useful because it gives project managers a second level of approval before they create invoices for customers.</span></span> <span data-ttu-id="8935b-105">První úroveň schválení je dokončena schválením časových a výdajových záznamů, které odešlou členové projektového týmu.</span><span class="sxs-lookup"><span data-stu-id="8935b-105">The first level of approval is completed when the time and expense entries that project team members submit are approved.</span></span>

<span data-ttu-id="8935b-106">Aplikace PSA není navržena pro generování zákaznických faktur, a to z následujících důvodů:</span><span class="sxs-lookup"><span data-stu-id="8935b-106">PSA isn't designed to generate customer-facing invoices, for the following reasons:</span></span>

- <span data-ttu-id="8935b-107">Neobsahuje daňové informace.</span><span class="sxs-lookup"><span data-stu-id="8935b-107">It doesn't contain tax information.</span></span>
- <span data-ttu-id="8935b-108">Neumí pomocí správně nakonfigurovaných směnných kurzů převést jiné měny na fakturační měnu.</span><span class="sxs-lookup"><span data-stu-id="8935b-108">It can't convert other currencies to the invoicing currency by using correctly configured exchange rates.</span></span>
- <span data-ttu-id="8935b-109">Neumí správně formátovat faktury, aby je bylo možné vytisknout.</span><span class="sxs-lookup"><span data-stu-id="8935b-109">It can't correctly format invoices so that they can be printed.</span></span>

<span data-ttu-id="8935b-110">Místo toho můžete k vytvoření zákaznických faktur, které používají informace z návrhů faktur generovaných v PSA, použít finanční nebo účetní systém.</span><span class="sxs-lookup"><span data-stu-id="8935b-110">Instead, you can use a financial or accounting system to create customer-facing invoices that use the information from invoice proposals that are generated in PSA.</span></span>

## <a name="creating-project-invoices-in-psa"></a><span data-ttu-id="8935b-111">Vytvoření projektových faktur v PSA</span><span class="sxs-lookup"><span data-stu-id="8935b-111">Creating project invoices in PSA</span></span>

<span data-ttu-id="8935b-112">Projektové faktury lze vytvářet jednotlivě nebo hromadně.</span><span class="sxs-lookup"><span data-stu-id="8935b-112">Project invoices can be created one at a time or in bulk.</span></span> <span data-ttu-id="8935b-113">Můžete je vytvořit ručně nebo je lze nakonfigurovat tak, aby byly generovány v automatických spuštěních.</span><span class="sxs-lookup"><span data-stu-id="8935b-113">You can create them manually, or they can be configured so that they are generated in automated runs.</span></span>

### <a name="manually-create-project-invoices-in-psa"></a><span data-ttu-id="8935b-114">Ruční vytvoření projektových faktur v PSA</span><span class="sxs-lookup"><span data-stu-id="8935b-114">Manually create project invoices in PSA</span></span>

<span data-ttu-id="8935b-115">Ze stránky se seznamem **Projektové smlouvy** můžete vytvořit projektové faktury samostatně pro každou projektovou smlouvu nebo můžete faktury vytvořit hromadně pro více projektových smluv.</span><span class="sxs-lookup"><span data-stu-id="8935b-115">From the **Project Contracts** list page, you can create project invoices separately for each project contract, or you can create invoices in bulk for multiple project contracts.</span></span>

<span data-ttu-id="8935b-116">Chcete-li vytvořit fakturu pro konkrétní projektovou smlouvu, postupujte podle tohoto kroku.</span><span class="sxs-lookup"><span data-stu-id="8935b-116">Follow this step to create an invoice for a specific project contract.</span></span>

- <span data-ttu-id="8935b-117">Na stránce se seznamem **Projektových smluv** otevřete projektovou smlouvu a pak vyberte **Vytvořit fakturu**.</span><span class="sxs-lookup"><span data-stu-id="8935b-117">On the **Project Contracts** list page, open a project contract, and then select **Create Invoice**.</span></span>

    ![Vytvoření projektových faktur pro konkrétní projektovou smlouvu](media/CreateProjectInvoicesOneByOne.png)

    <span data-ttu-id="8935b-119">Je vygenerována faktura pro všechny transakce vybrané projektové smlouvy, které mají stav **Připraveno k fakturaci**.</span><span class="sxs-lookup"><span data-stu-id="8935b-119">An invoice is generated for all transactions for the selected project contract that have a status of **Ready to Invoice**.</span></span> <span data-ttu-id="8935b-120">Tyto transakce zahrnují čas, výdaje, milníky a řádky smlouvy založené na produktu.</span><span class="sxs-lookup"><span data-stu-id="8935b-120">These transactions include time, expenses, milestones, and product-based contract lines.</span></span>

<span data-ttu-id="8935b-121">Chcete-li vytvořit faktury hromadně, postupujte následovně.</span><span class="sxs-lookup"><span data-stu-id="8935b-121">Follow these steps to create invoices in bulk.</span></span>

1. <span data-ttu-id="8935b-122">Na stránce se seznamem **Projektových smluv** vyberte jednu nebo více projektových smluv, pro které musíte vytvořit fakturu, a pak vyberte **Vytvořit projektové faktury**.</span><span class="sxs-lookup"><span data-stu-id="8935b-122">On the **Project Contracts** list page, select one or more project contracts that you must create an invoice for, and then select **Create Project Invoices**.</span></span>

    ![Hromadné vytvoření projektových faktur](media/CreateProjectInvoicesBulk.png)

    <span data-ttu-id="8935b-124">Zobrazí se zpráva s upozorněním, že před vytvořením faktur může dojít k prodlevě.</span><span class="sxs-lookup"><span data-stu-id="8935b-124">A warning message informs you that there might be a delay before invoices are created.</span></span> <span data-ttu-id="8935b-125">Tento proces je také zobrazen.</span><span class="sxs-lookup"><span data-stu-id="8935b-125">The process is also shown.</span></span>

2. <span data-ttu-id="8935b-126">Výběrem **OK** zavřete dialogové okno.</span><span class="sxs-lookup"><span data-stu-id="8935b-126">Select **OK** to close the message box.</span></span>

    <span data-ttu-id="8935b-127">Je vygenerována faktura pro všechny transakce na řádku smlouvy, které mají stav **Připraveno k fakturaci**.</span><span class="sxs-lookup"><span data-stu-id="8935b-127">An invoice is generated for all transactions on a contract line that have a status of **Ready to Invoice**.</span></span> <span data-ttu-id="8935b-128">Tyto transakce zahrnují čas, výdaje, milníky a řádky smlouvy založené na produktu.</span><span class="sxs-lookup"><span data-stu-id="8935b-128">These transactions include time, expenses, milestones, and product-based contract lines.</span></span>

3. <span data-ttu-id="8935b-129">Chcete-li zobrazit generované faktury, přejděte do **Prodej** \> **Fakturace** \> **Faktury**.</span><span class="sxs-lookup"><span data-stu-id="8935b-129">To view the invoices that are generated, go to **Sales** \> **Billing** \> **Invoices**.</span></span> <span data-ttu-id="8935b-130">Pro každou projektovou smlouvu se zobrazí jedna faktura.</span><span class="sxs-lookup"><span data-stu-id="8935b-130">You will see one invoice for each project contract.</span></span>

### <a name="set-up-automated-creation-of-project-invoices-in-psa"></a><span data-ttu-id="8935b-131">Nastavení automatického vytváření projektových faktur v PSA</span><span class="sxs-lookup"><span data-stu-id="8935b-131">Set up automated creation of project invoices in PSA</span></span>

<span data-ttu-id="8935b-132">Chcete-li nakonfigurovat spuštění automatické fakturace v PSA, postupujte následujícím způsobem.</span><span class="sxs-lookup"><span data-stu-id="8935b-132">Follow these steps to configure an automated invoice run in PSA.</span></span>

1. <span data-ttu-id="8935b-133">Přejděte do **Project Service** \> **Nastavení** \> **Dávkové úlohy**.</span><span class="sxs-lookup"><span data-stu-id="8935b-133">Go to **Project Service** \> **Settings** \> **Batch jobs**.</span></span>
2. <span data-ttu-id="8935b-134">Vytvořte dávkovou úlohu a pojmenujte ji **Vytvořit faktury v PSA.**</span><span class="sxs-lookup"><span data-stu-id="8935b-134">Create a batch job, and name it **PSA Create Invoices**.</span></span> <span data-ttu-id="8935b-135">Název dávkové úlohy musí obsahovat termín „Vytvořit faktury”.</span><span class="sxs-lookup"><span data-stu-id="8935b-135">The name of the batch job must include the term "Create Invoices."</span></span>
3. <span data-ttu-id="8935b-136">V poli **Typ úlohy** vyberte **Žádný**.</span><span class="sxs-lookup"><span data-stu-id="8935b-136">In the **Job type** field, select **None**.</span></span> <span data-ttu-id="8935b-137">Ve výchozím nastavení jsou možnosti **Frekvence denně** a **Je aktivní** nastaveny na **Ano**.</span><span class="sxs-lookup"><span data-stu-id="8935b-137">By default, the **Frequency Daily** and **Is Active** options are set to **Yes**.</span></span>
4. <span data-ttu-id="8935b-138">Vyberte **Spustit pracovní postup**.</span><span class="sxs-lookup"><span data-stu-id="8935b-138">Select **Run Workflow**.</span></span> <span data-ttu-id="8935b-139">V dialogovém okně **Vyhledat záznam** se zobrazí tři pracovní postupy:</span><span class="sxs-lookup"><span data-stu-id="8935b-139">In the **Look Up Record** dialog box, you will see three workflows:</span></span>

    - <span data-ttu-id="8935b-140">ProcessRunCaller</span><span class="sxs-lookup"><span data-stu-id="8935b-140">ProcessRunCaller</span></span>
    - <span data-ttu-id="8935b-141">ProcessRunner</span><span class="sxs-lookup"><span data-stu-id="8935b-141">ProcessRunner</span></span>
    - <span data-ttu-id="8935b-142">UpdateRoleUtilization</span><span class="sxs-lookup"><span data-stu-id="8935b-142">UpdateRoleUtilization</span></span>

5. <span data-ttu-id="8935b-143">Vyberte **ProcessRunCaller** a potom vyberte **Přidat**.</span><span class="sxs-lookup"><span data-stu-id="8935b-143">Select **ProcessRunCaller**, and then select **Add**.</span></span>
6. <span data-ttu-id="8935b-144">V dalším dialogovém okně vyberte **OK**.</span><span class="sxs-lookup"><span data-stu-id="8935b-144">In the next dialog box, select **OK**.</span></span> <span data-ttu-id="8935b-145">Po pracovním postupu **Spánek** následuje pracovní postup **Zpracovat**.</span><span class="sxs-lookup"><span data-stu-id="8935b-145">A **Sleep** workflow is followed by a **Process** workflow.</span></span>

    <span data-ttu-id="8935b-146">Pracovní postup **ProcessRunner** můžete také vybrat v kroku 5.</span><span class="sxs-lookup"><span data-stu-id="8935b-146">You can also select **ProcessRunner** in step 5.</span></span> <span data-ttu-id="8935b-147">Když potom vyberete **OK**, bude pracovní postup **Zpracovat** následován pracovním postupem **Spánek**.</span><span class="sxs-lookup"><span data-stu-id="8935b-147">Then, when you select **OK**, a **Process** workflow is followed by a **Sleep** workflow.</span></span>

<span data-ttu-id="8935b-148">Pracovní postupy **ProcessRunCaller** a **ProcessRunner** vytvářejí faktury.</span><span class="sxs-lookup"><span data-stu-id="8935b-148">The **ProcessRunCaller** and **ProcessRunner** workflows create invoices.</span></span> <span data-ttu-id="8935b-149">**ProcessRunCaller** volá **ProcessRunner**.</span><span class="sxs-lookup"><span data-stu-id="8935b-149">**ProcessRunCaller** calls **ProcessRunner**.</span></span> <span data-ttu-id="8935b-150">**ProcessRunner** je pracovní postup, který skutečně vytváří faktury.</span><span class="sxs-lookup"><span data-stu-id="8935b-150">**ProcessRunner** is the workflow that actually creates the invoices.</span></span> <span data-ttu-id="8935b-151">Prochází všemi řádky smluv, pro které musí být vytvořeny faktury, a vytváří faktury pro tyto řádky.</span><span class="sxs-lookup"><span data-stu-id="8935b-151">It goes through all the contract lines that invoices must be created for, and it creates invoices for those lines.</span></span> <span data-ttu-id="8935b-152">Aby určil řádky smluv, pro které musí být vytvořeny faktury, vyhledává úloha data spuštění faktury pro řádky smluv.</span><span class="sxs-lookup"><span data-stu-id="8935b-152">To determine the contract lines that invoices must be created for, the job looks at invoice run dates for the contract lines.</span></span> <span data-ttu-id="8935b-153">Jestliže řádky smluv, které patří k jedné smlouvě, mají stejné datum spuštění faktury, budou transakce sloučeny do jedné faktury, která má dva řádky faktury.</span><span class="sxs-lookup"><span data-stu-id="8935b-153">If contract lines that belong to one contract have the same invoice run date, the transactions are combined into one invoice that has two invoice lines.</span></span> <span data-ttu-id="8935b-154">Pokud neexistují žádné transakce pro vytvoření faktur, úloha přeskočí vytvoření faktury.</span><span class="sxs-lookup"><span data-stu-id="8935b-154">If there are no transactions to create invoices for, the job skips invoice creation.</span></span>

<span data-ttu-id="8935b-155">Proces **ProcessRunner** po svém dokončení volá proces **ProcessRunCaller**, poskytne čas ukončení a je zavřen.</span><span class="sxs-lookup"><span data-stu-id="8935b-155">After **ProcessRunner** has finished running, it calls **ProcessRunCaller**, provides the end time, and is closed.</span></span> <span data-ttu-id="8935b-156">Proces **ProcessRunCaller** poté spustí časovač, který běží po dobu 24 hodin od zadaného času ukončení.</span><span class="sxs-lookup"><span data-stu-id="8935b-156">**ProcessRunCaller** then starts a timer that runs for 24 hours from the specified end time.</span></span> <span data-ttu-id="8935b-157">Po doběhnutí časovače je **ProcessRunCaller** uzavřen.</span><span class="sxs-lookup"><span data-stu-id="8935b-157">At the end of the timer, **ProcessRunCaller** is closed.</span></span>

<span data-ttu-id="8935b-158">Úloha dávkového zpracování pro vytváření faktur je opakující se úloha.</span><span class="sxs-lookup"><span data-stu-id="8935b-158">The batch process job for creating invoices is a recurrent job.</span></span> <span data-ttu-id="8935b-159">Pokud je tento dávkový proces spuštěn vícekrát, vytvoří se více instancí této úlohy a způsobí chyby.</span><span class="sxs-lookup"><span data-stu-id="8935b-159">If this batch process is run many times, multiple instances of the job are created and cause errors.</span></span> <span data-ttu-id="8935b-160">Proto byste tento dávkový proces měli spustit pouze jednou a restartovat ho, pouze pokud přestane běžet.</span><span class="sxs-lookup"><span data-stu-id="8935b-160">Therefore, you should start the batch process only one time, and you should restart it only if it stops running.</span></span>
 
### <a name="edit-a-draft-psa-invoice"></a><span data-ttu-id="8935b-161">Úprava konceptu faktury PSA</span><span class="sxs-lookup"><span data-stu-id="8935b-161">Edit a draft PSA invoice</span></span>

<span data-ttu-id="8935b-162">Když vytváříte koncept projektové faktury, jsou všechny nefakturované prodejní transakce, které byly vytvořeny při schválení časových a výdajových záznamů, načteny do faktury.</span><span class="sxs-lookup"><span data-stu-id="8935b-162">When you create a draft project invoice, all unbilled sales transactions that were created when the time and expense entries were approved are pulled onto the invoice.</span></span> <span data-ttu-id="8935b-163">Dokud je faktura stále ve fázi konceptu, můžete provést následující úpravy:</span><span class="sxs-lookup"><span data-stu-id="8935b-163">You can make the following adjustments while the invoice is still in a draft stage:</span></span>

- <span data-ttu-id="8935b-164">Odstranit nebo upravit podrobnosti řádku faktury.</span><span class="sxs-lookup"><span data-stu-id="8935b-164">Delete or edit invoice line details.</span></span>
- <span data-ttu-id="8935b-165">Upravit a přizpůsobit množství a typ fakturace.</span><span class="sxs-lookup"><span data-stu-id="8935b-165">Edit and adjust the quantity and billing type.</span></span>
- <span data-ttu-id="8935b-166">Přímo přidat čas, náklady a poplatky jako transakce na faktuře.</span><span class="sxs-lookup"><span data-stu-id="8935b-166">Directly add time, expense, and fees as transactions on the invoice.</span></span> <span data-ttu-id="8935b-167">Tuto funkci můžete použít v případě, že je řádek faktury namapován na řádek smlouvy, který umožňuje tyto třídy transakcí.</span><span class="sxs-lookup"><span data-stu-id="8935b-167">You can use this feature if the invoice line is mapped to a contract line that allows for these transaction classes.</span></span>

<span data-ttu-id="8935b-168">Chcete-li fakturu potvrdit, vyberte **Potvrdit**.</span><span class="sxs-lookup"><span data-stu-id="8935b-168">Select **Confirm** to confirm an invoice.</span></span> <span data-ttu-id="8935b-169">Akce Potvrdit představuje jednosměrnou akci.</span><span class="sxs-lookup"><span data-stu-id="8935b-169">The Confirm action is a one-way action.</span></span> <span data-ttu-id="8935b-170">Když vyberete **Potvrdit**, systém nastaví fakturu jen pro čtení a vytvoří skutečné fakturované hodnoty z každé podrobnosti řádku faktury pro každý řádek faktury.</span><span class="sxs-lookup"><span data-stu-id="8935b-170">When you select **Confirm**, the system makes the invoice read-only and creates billed sales actuals from each invoice line detail for each invoice line.</span></span> <span data-ttu-id="8935b-171">Pokud podrobnosti řádku faktury odkazují na nefakturovanou skutečnou hodnotu prodeje, tak systém také stornuje nefakturovanou skutečnou hodnotu prodeje.</span><span class="sxs-lookup"><span data-stu-id="8935b-171">If the invoice line detail references an unbilled sales actual, the system also reverses the unbilled sales actual.</span></span> <span data-ttu-id="8935b-172">(Všechny podrobnosti řádku faktury vytvořené z časových nebo výdajových záznamů budou odkazovat na nefakturovanou skutečnou hodnotu prodeje.) Systémy integrace hlavní knihy mohou toto storno použít ke zrušení probíhající práce (WIP) pro účetní účely.</span><span class="sxs-lookup"><span data-stu-id="8935b-172">(Any invoice line detail that was created from a time or expense entry will reference an unbilled sales actual.) General ledger integration systems can use this reversal to reverse project work in progress (WIP) for accounting purposes.</span></span>

### <a name="correct-a-confirmed-psa-invoice"></a><span data-ttu-id="8935b-173">Oprava potvrzené faktury PSA</span><span class="sxs-lookup"><span data-stu-id="8935b-173">Correct a confirmed PSA invoice</span></span>

<span data-ttu-id="8935b-174">Potvrzené faktury PSA lze upravovat (opravovat).</span><span class="sxs-lookup"><span data-stu-id="8935b-174">Confirmed PSA invoices can be edited (corrected).</span></span> <span data-ttu-id="8935b-175">Když opravíte potvrzenou fakturu, vytvoří se nový koncept opravné faktury.</span><span class="sxs-lookup"><span data-stu-id="8935b-175">When you correct a confirmed invoice, a new draft corrective invoice is created.</span></span> <span data-ttu-id="8935b-176">Protože se předpokládá, že chcete zrušit všechny transakce a množství z původní faktury, obsahuje tato opravná faktura všechny transakce z původní faktury a všechna množství na ní jsou 0 (nula).</span><span class="sxs-lookup"><span data-stu-id="8935b-176">Because the assumption is that you want to reverse all the transactions and quantities from the original invoice, this corrective invoice includes all the transactions from the original invoice, and all the quantities on it are 0 (zero).</span></span>

<span data-ttu-id="8935b-177">Pokud transakce nevyžadují opravu, můžete je odebrat z konceptu opravné faktury.</span><span class="sxs-lookup"><span data-stu-id="8935b-177">If any transactions don't require correction, you can remove them from the draft corrective invoice.</span></span> <span data-ttu-id="8935b-178">Pokud chcete zrušit nebo vrátit pouze částečné množství, můžete upravit pole **Množství** v podrobnostech řádku.</span><span class="sxs-lookup"><span data-stu-id="8935b-178">If you want to reverse or return only a partial quantity, you can edit the **Quantity** field on the line detail.</span></span> <span data-ttu-id="8935b-179">Pokud otevřete podrobnosti řádku faktury, uvidíte původní množství faktury.</span><span class="sxs-lookup"><span data-stu-id="8935b-179">If you open the invoice line detail, you can see the original invoice quantity.</span></span> <span data-ttu-id="8935b-180">Potom můžete upravit aktuální množství faktury tak, aby bylo menší nebo větší než původní množství faktury.</span><span class="sxs-lookup"><span data-stu-id="8935b-180">You can then edit the current invoice quantity so that it's less than or more than the original invoice quantity.</span></span>

<span data-ttu-id="8935b-181">Po potvrzení opravné faktury se původní skutečná hodnota fakturovaného prodeje stornuje a vytvoří se nová skutečná hodnota fakturovaného prodeje.</span><span class="sxs-lookup"><span data-stu-id="8935b-181">When you confirm a corrective invoice, the original billed sales actual is reversed, and a new billed sales actual is created.</span></span> <span data-ttu-id="8935b-182">Pokud bylo množství sníženo, rozdíl způsobí, že bude vytvořena i nová skutečná hodnota nefakturovaného prodeje.</span><span class="sxs-lookup"><span data-stu-id="8935b-182">If the quantity was reduced, the difference will cause a new unbilled sales actual to be created too.</span></span> <span data-ttu-id="8935b-183">Pokud byl například původní fakturovaný prodej na 8 hodin a opravné podrobnosti řádku faktury obsahují snížené množství 6 hodin, vrátí PSA původní vyfakturované prodejní řádky a vytvoří dvě nové skutečné hodnoty:</span><span class="sxs-lookup"><span data-stu-id="8935b-183">For example, if the original billed sales was for eight hours, and the corrective invoice line detail has a reduced quantity of six hours, PSA reverses the original billed sales line and creates two new actuals:</span></span>

- <span data-ttu-id="8935b-184">Fakturovaná skutečná hodnota prodeje pro 6 hodin.</span><span class="sxs-lookup"><span data-stu-id="8935b-184">A billed sales actual for six hours.</span></span>
- <span data-ttu-id="8935b-185">Skutečná hodnota nefakturovaného prodeje pro zbývající dvě hodiny.</span><span class="sxs-lookup"><span data-stu-id="8935b-185">An unbilled sales actual for the remaining two hours.</span></span> <span data-ttu-id="8935b-186">Tato transakce může být buď fakturována později, nebo označena jako neúčtovatelná, v závislosti na jednáních se zákazníkem.</span><span class="sxs-lookup"><span data-stu-id="8935b-186">This transaction can either be billed later or marked as non-chargeable, depending on the negotiations with the customer.</span></span>
